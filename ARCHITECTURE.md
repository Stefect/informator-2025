# üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ CaptureStream - YouTube Live Clone

## üìä –î—ñ–∞–≥—Ä–∞–º–∞ —Å–∏—Å—Ç–µ–º–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –ö–õ–Ü–Ñ–ù–¢–ò (USERS)                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                 ‚îÇ               ‚îÇ               ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ  OBS    ‚îÇ     ‚îÇ Browser ‚îÇ     ‚îÇ Browser ‚îÇ
            ‚îÇ Studio  ‚îÇ     ‚îÇ Streamer‚îÇ     ‚îÇ Viewer  ‚îÇ
            ‚îÇ (RTMP)  ‚îÇ     ‚îÇ(WebRTC) ‚îÇ     ‚îÇ (HLS)   ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                 ‚îÇ               ‚îÇ               ‚îÇ
                 ‚îÇ    RTMP       ‚îÇ   WebSocket   ‚îÇ   HTTP
                 ‚îÇ   :1935       ‚îÇ    :3001      ‚îÇ   :8000
                 ‚îÇ               ‚îÇ               ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –°–ï–†–í–ï–†–ù–ò–ô –®–ê–†                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                        ‚îÇ
‚îÇ  ‚îÇ  RTMP Server   ‚îÇ        ‚îÇ WebSocket      ‚îÇ                        ‚îÇ
‚îÇ  ‚îÇ  (Node-Media)  ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ Server         ‚îÇ                        ‚îÇ
‚îÇ  ‚îÇ  Port: 1935    ‚îÇ        ‚îÇ (Express+WS)   ‚îÇ                        ‚îÇ
‚îÇ  ‚îÇ  Port: 8000    ‚îÇ        ‚îÇ Port: 3001     ‚îÇ                        ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                        ‚îÇ
‚îÇ           ‚îÇ                         ‚îÇ                                ‚îÇ
‚îÇ           ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§                                ‚îÇ
‚îÇ           ‚îÇ    ‚îÇ                    ‚îÇ                                ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                       ‚îÇ
‚îÇ  ‚îÇ   FFmpeg        ‚îÇ       ‚îÇ  Stream Manager ‚îÇ                       ‚îÇ
‚îÇ  ‚îÇ   Transcoder    ‚îÇ       ‚îÇ  (Metadata)     ‚îÇ                       ‚îÇ
‚îÇ  ‚îÇ                 ‚îÇ       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                       ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ RTMP‚ÜíHLS      ‚îÇ                ‚îÇ                                ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Recording     ‚îÇ                ‚îÇ                                ‚îÇ
‚îÇ  ‚îÇ ‚Ä¢ Thumbnails    ‚îÇ                ‚îÇ                                ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                ‚îÇ                                ‚îÇ
‚îÇ           ‚îÇ                         ‚îÇ                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ                         ‚îÇ
            ‚îÇ                         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                        –ó–ë–ï–†–Ü–ì–ê–ù–ù–Ø (STORAGE)                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                                       ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ   HLS Segments   ‚îÇ  ‚îÇ   Recordings     ‚îÇ  ‚îÇ   Metadata DB    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ media/hls/       ‚îÇ  ‚îÇ media/           ‚îÇ  ‚îÇ streams.json     ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îú‚îÄ live/         ‚îÇ  ‚îÇ recordings/      ‚îÇ  ‚îÇ                  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îÇ  ‚îú‚îÄ stream1/   ‚îÇ  ‚îÇ ‚îú‚îÄ video1.mp4    ‚îÇ  ‚îÇ {stream info,    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îÇ  ‚îÇ  ‚îú‚îÄ .m3u8   ‚îÇ  ‚îÇ ‚îú‚îÄ video2.mp4    ‚îÇ  ‚îÇ  viewers,        ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îÇ  ‚îÇ  ‚îú‚îÄ .ts     ‚îÇ  ‚îÇ ‚îî‚îÄ video3.mp4    ‚îÇ  ‚îÇ  duration}       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ ‚îÇ  ‚îÇ  ‚îî‚îÄ .ts     ‚îÇ  ‚îÇ                  ‚îÇ  ‚îÇ                  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–∏—Ö (Data Flow)

### 1. üì° RTMP Streaming (OBS ‚Üí –°–µ—Ä–≤–µ—Ä)

```
OBS Studio
    ‚îÇ
    ‚îÇ RTMP Stream (H.264 + AAC)
    ‚îÇ rtmp://localhost:1935/live/stream_key
    ‚ñº
Node-Media-Server (Port 1935)
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ FFmpeg Transcoder
    ‚îÇ   ‚îÇ
    ‚îÇ   ‚îú‚îÄ‚ñ∫ HLS Converter (.m3u8 + .ts segments)
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚ñ∫ media/hls/live/stream_key/
    ‚îÇ   ‚îÇ
    ‚îÇ   ‚îî‚îÄ‚ñ∫ MP4 Recorder
    ‚îÇ       ‚îî‚îÄ‚ñ∫ media/recordings/stream_key_timestamp.mp4
    ‚îÇ
    ‚îî‚îÄ‚ñ∫ Stream Manager
        ‚îî‚îÄ‚ñ∫ streams.json (metadata)
```

### 2. üåê WebRTC Streaming (Browser ‚Üí –°–µ—Ä–≤–µ—Ä)

```
Browser (Screen Capture API)
    ‚îÇ
    ‚îÇ getDisplayMedia()
    ‚îÇ MediaStream (VP8/VP9)
    ‚ñº
WebSocket (Port 3001)
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ JPEG Frames (Binary Data)
    ‚îÇ   ‚îî‚îÄ‚ñ∫ Broadcast to all viewers
    ‚îÇ
    ‚îî‚îÄ‚ñ∫ Stream Info (JSON Messages)
        ‚îú‚îÄ‚ñ∫ register
        ‚îú‚îÄ‚ñ∫ startStream
        ‚îî‚îÄ‚ñ∫ stopStream
```

### 3. üëÅÔ∏è Viewing (–ì–ª—è–¥–∞—á)

```
Browser Viewer
    ‚îÇ
    ‚îú‚îÄ‚ñ∫ HTTP Request
    ‚îÇ   ‚îî‚îÄ‚ñ∫ GET http://localhost:8000/live/stream_key/index.m3u8
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚ñº
    ‚îÇ   HLS Player (hls.js / Video.js)
    ‚îÇ       ‚îÇ
    ‚îÇ       ‚îî‚îÄ‚ñ∫ Segments (.ts files)
    ‚îÇ
    ‚îî‚îÄ‚ñ∫ WebSocket Connection
        ‚îî‚îÄ‚ñ∫ Real-time chat, viewer count, metadata
```

---

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å–∏—Å—Ç–µ–º–∏

### 1. üì° RTMP Server (`src/rtmp-server.ts`)

**–§—É–Ω–∫—Ü—ñ—ó:**
- ‚úÖ –ü—Ä–∏–π–º–∞—î RTMP —Å—Ç—Ä—ñ–º–∏ –≤—ñ–¥ OBS
- ‚úÖ –¢—Ä–∞–Ω—Å–∫–æ–¥—É—î –≤ HLS –¥–ª—è –±—Ä–∞—É–∑–µ—Ä—ñ–≤
- ‚úÖ –ó–∞–ø–∏—Å—É—î –≤ MP4 —Ñ–∞–π–ª–∏
- ‚úÖ HTTP-FLV –¥–ª—è –Ω–∏–∑—å–∫–æ—ó –∑–∞—Ç—Ä–∏–º–∫–∏
- ‚úÖ –ó–±–µ—Ä—ñ–≥–∞—î –º–µ—Ç–∞–¥–∞–Ω—ñ —Å—Ç—Ä—ñ–º—ñ–≤

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:**
- `node-media-server` - RTMP —Å–µ—Ä–≤–µ—Ä
- `fluent-ffmpeg` - –û–±—Ä–æ–±–∫–∞ –≤—ñ–¥–µ–æ
- FFmpeg - –¢—Ä–∞–Ω—Å–∫–æ–¥–∏–Ω–≥

**–ü–æ—Ä—Ç–∏:**
- `1935` - RTMP ingestion
- `8000` - HTTP-FLV + HLS delivery

---

### 2. üîå WebSocket Server (`src/server.ts`)

**–§—É–Ω–∫—Ü—ñ—ó:**
- ‚úÖ WebRTC screen capture (browser)
- ‚úÖ Real-time frame broadcasting
- ‚úÖ Stream management API
- ‚úÖ Viewer count tracking
- ‚úÖ Chat system

**–¢–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó:**
- `Express` - HTTP —Å–µ—Ä–≤–µ—Ä
- `ws` - WebSocket library
- `winston` - Logging

**–ü–æ—Ä—Ç:**
- `3001` - WebSocket + HTTP API

---

### 3. üé® Frontend (`public/`)

**–°—Ç–æ—Ä—ñ–Ω–∫–∏:**
- `index.html` - –ì–æ–ª–æ–≤–Ω–∞ (—Å–ø–∏—Å–æ–∫ —Å—Ç—Ä—ñ–º—ñ–≤)
- `studio.html` - –°—Ç—É–¥—ñ—è —Å—Ç—Ä—ñ–º–µ—Ä–∞
- `watch.html` - –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç—Ä—ñ–º—É
- `library.html` - –í—ñ–¥–µ–æ—Ç–µ–∫–∞ (VOD)

**–§—É–Ω–∫—Ü—ñ—ó:**
- ‚úÖ YouTube-style UI
- ‚úÖ Sidebar navigation
- ‚úÖ Live stream cards
- ‚úÖ Video player controls
- ‚úÖ Real-time chat
- ‚úÖ Stream statistics

---

### 4. üíæ Storage Layer

**HLS Segments (`media/hls/`):**
```
hls/
‚îî‚îÄ‚îÄ live/
    ‚îî‚îÄ‚îÄ stream_key/
        ‚îú‚îÄ‚îÄ index.m3u8      # Playlist
        ‚îú‚îÄ‚îÄ segment0.ts     # 2-10 sec chunks
        ‚îú‚îÄ‚îÄ segment1.ts
        ‚îî‚îÄ‚îÄ segment2.ts
```

**Recordings (`media/recordings/`):**
```
recordings/
‚îú‚îÄ‚îÄ live_stream1_2025-01-15T12-00-00.mp4
‚îú‚îÄ‚îÄ live_stream2_2025-01-15T14-30-00.mp4
‚îî‚îÄ‚îÄ live_stream3_2025-01-15T18-45-00.mp4
```

**Metadata (`streams.json`):**
```json
[
  {
    "id": "client_123456",
    "app": "live",
    "stream": "stream_key",
    "startTime": 1705320000000,
    "endTime": 1705323600000,
    "duration": 3600,
    "recordingPath": "media/recordings/live_stream1.mp4",
    "hlsPath": "live/stream_key/index.m3u8"
  }
]
```

---

## üîÄ –ü—Ä–æ—Ç–æ–∫–æ–ª–∏

### RTMP (Real-Time Messaging Protocol)
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** OBS ‚Üí –°–µ—Ä–≤–µ—Ä
- **–ü–æ—Ä—Ç:** 1935
- **–ö–æ–¥–µ–∫:** H.264 (video) + AAC (audio)
- **–ó–∞—Ç—Ä–∏–º–∫–∞:** ~5-10 —Å–µ–∫—É–Ω–¥
- **–ü–µ—Ä–µ–≤–∞–≥–∏:** –°—Ç–∞–±—ñ–ª—å–Ω–∏–π, –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –∫–æ–¥–µ—Ä–∞–º–∏

### HLS (HTTP Live Streaming)
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –°–µ—Ä–≤–µ—Ä ‚Üí –ë—Ä–∞—É–∑–µ—Ä–∏
- **–ü–æ—Ä—Ç:** 8000 (HTTP)
- **–§–æ—Ä–º–∞—Ç:** .m3u8 playlist + .ts segments
- **–ó–∞—Ç—Ä–∏–º–∫–∞:** ~10-30 —Å–µ–∫—É–Ω–¥
- **–ü–µ—Ä–µ–≤–∞–≥–∏:** –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞, CDN-ready

### WebSocket
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –ë—Ä–∞—É–∑–µ—Ä ‚Üî –°–µ—Ä–≤–µ—Ä
- **–ü–æ—Ä—Ç:** 3001
- **–§–æ—Ä–º–∞—Ç:** Binary (frames) + JSON (messages)
- **–ó–∞—Ç—Ä–∏–º–∫–∞:** ~100-500ms
- **–ü–µ—Ä–µ–≤–∞–≥–∏:** –ù–∏–∑—å–∫–∞ –∑–∞—Ç—Ä–∏–º–∫–∞, –¥–≤–æ—Å—Ç–æ—Ä–æ–Ω–Ω—î –∑'—î–¥–Ω–∞–Ω–Ω—è

### HTTP-FLV
- **–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:** –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ HLS
- **–ü–æ—Ä—Ç:** 8000
- **–§–æ—Ä–º–∞—Ç:** FLV over HTTP
- **–ó–∞—Ç—Ä–∏–º–∫–∞:** ~3-5 —Å–µ–∫—É–Ω–¥
- **–ü–µ—Ä–µ–≤–∞–≥–∏:** –ù–∏–∂—á–∞ –∑–∞—Ç—Ä–∏–º–∫–∞ –Ω—ñ–∂ HLS

---

## üöÄ –ü–æ—Ç—ñ–∫ –∑–∞–ø—É—Å–∫—É

### 1. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä—ñ–≤
```bash
npm run build        # –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è TypeScript
npm run start:all    # –û–±–∏–¥–≤–∞ —Å–µ—Ä–≤–µ—Ä–∏ —Ä–∞–∑–æ–º
```

### 2. –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –ø–æ–¥—ñ—ó "Stream Start"
```typescript
// RTMP —Å–µ—Ä–≤–µ—Ä
nms.on('postPublish', (id, StreamPath) => {
  // 1. –°—Ç–≤–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Å –≤ streams.json
  // 2. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ FFmpeg —Ç—Ä–∞–Ω—Å–∫–æ–¥–∏–Ω–≥
  // 3. –ü–æ–≤—ñ–¥–æ–º–∏—Ç–∏ WebSocket –∫–ª—ñ—î–Ω—Ç—ñ–≤
});
```

### 3. –†–æ–∑–ø–æ–≤—Å—é–¥–∂–µ–Ω–Ω—è –∫–∞–¥—Ä—ñ–≤
```typescript
// WebSocket broadcast
captureSession.viewers.forEach(viewer => {
  viewer.ws.send(frameData); // Binary
});
```

### 4. –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è —Å—Ç—Ä—ñ–º—É
```typescript
nms.on('donePublish', (id, StreamPath) => {
  // 1. –ó—É–ø–∏–Ω–∏—Ç–∏ FFmpeg
  // 2. –§—ñ–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ MP4 —Ñ–∞–π–ª
  // 3. –û–Ω–æ–≤–∏—Ç–∏ metadata –∑ duration
  // 4. –ü–æ–≤—ñ–¥–æ–º–∏—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤
});
```

---

## üìä API Endpoints

### Stream Management

```
GET  /api/status              # –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–µ—Ä–∞
GET  /api/streams             # –ê–∫—Ç–∏–≤–Ω—ñ —Å—Ç—Ä—ñ–º–∏
GET  /api/stream/:id          # –Ü–Ω—Ñ–æ –ø—Ä–æ —Å—Ç—Ä—ñ–º
GET  /api/recordings          # –ó–∞–ø–∏—Å–∞–Ω—ñ –≤—ñ–¥–µ–æ
POST /api/capture/config      # –û–Ω–æ–≤–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
```

### WebSocket Messages

**Client ‚Üí Server:**
```json
{ "type": "register", "role": "viewer" }
{ "type": "getStreams" }
{ "type": "start_native_capture", "config": {...} }
```

**Server ‚Üí Client:**
```json
{ "type": "streamList", "streams": [...] }
{ "type": "viewerCount", "count": 42 }
{ "type": "streamEnded", "streamId": "..." }
```

---

## üîê Security (–ú–∞–π–±—É—Ç–Ω—î)

1. **Stream Keys:** –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∫–ª—é—á—ñ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å—Ç—Ä—ñ–º–µ—Ä–∞
2. **Auth Middleware:** JWT —Ç–æ–∫–µ–Ω–∏
3. **Rate Limiting:** –û–±–º–µ–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤
4. **CORS:** –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–æ–∑–≤–æ–ª–µ–Ω–∏—Ö –¥–æ–º–µ–Ω—ñ–≤
5. **Encryption:** SSL/TLS –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

---

## üìà –ú–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è

### Horizontal Scaling
- **Load Balancer** (Nginx)
- **Multiple Workers** (PM2 cluster mode)
- **Redis** –¥–ª—è shared state
- **CDN** –¥–ª—è HLS delivery

### Vertical Scaling
- **–ë—ñ–ª—å—à–µ CPU:** –î–ª—è FFmpeg —Ç—Ä–∞–Ω—Å–∫–æ–¥–∏–Ω–≥—É
- **–ë—ñ–ª—å—à–µ RAM:** –î–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è
- **SSD Storage:** –î–ª—è —à–≤–∏–¥–∫–æ–≥–æ –∑–∞–ø–∏—Å—É

---

## üéØ Roadmap

- [x] RTMP —Å–µ—Ä–≤–µ—Ä
- [x] HLS –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è
- [x] –ó–∞–ø–∏—Å —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ–π
- [x] YouTube-style UI
- [ ] WebRTC –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
- [ ] –ß–∞—Ç —Å–∏—Å—Ç–µ–º–∞
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö (MongoDB/PostgreSQL)
- [ ] –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
- [ ] VOD –≤—ñ–¥–µ–æ—Ç–µ–∫–∞
- [ ] CDN —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è
- [ ] Analytics dashboard
- [ ] Mobile app

---

**–ê–≤—Ç–æ—Ä:** CaptureStream Team  
**–í–µ—Ä—Å—ñ—è:** 2.0.0  
**–î–∞—Ç–∞:** 2025
